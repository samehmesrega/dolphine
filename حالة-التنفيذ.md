# حالة تنفيذ تطبيق دولفين

## 1. ما تم تنفيذه

| القسم | الميزة | التفاصيل |
|--------|--------|----------|
| **البنية الأساسية** | Backend | Express + Prisma + PostgreSQL (Neon)، JWT، تطبيع أرقام الهواتف |
| | Frontend | React + TypeScript + Vite + Tailwind |
| | تسجيل الدخول | POST /api/auth/login + واجهة Login |
| | Seed | أدوار، حالات ليد، مستخدم سوبر أدمن (admin@dolphin.local / admin123) |
| **الداشبورد** | إحصائيات | إجمالي الليدز، الطلبات، بانتظار الحسابات من API |
| | روابط | روابط سريعة للأقسام |
| **الليدز** | قائمة | بحث، فلتر بالحالة، فلتر بالمعيّن له، ترقيم، عمود المعيّن له |
| | ترتيب | الأحدث، الأقدم، الاسم، الحالة |
| | إضافة ليد يدوي | فورم في نفس الصفحة |
| | تصدير CSV | تصدير حتى 1000 ليد حسب الفلاتر الحالية |
| | تفاصيل الليد | بيانات، تعديل، تعيين موظف، واتساب |
| | تحويل لعميل | تغيير الحالة لـ «طلب مؤكد» |
| | إنشاء الطلب | زر يوجّه لصفحة إنشاء الطلب |
| | سجل التواصُل | إضافة تواصُل (نوع، ملخص، تحديث حالة، طلب رد من مستخدمين) |
| | طلبات الرد | عرض طلبات الرد المعلقة |
| | اهتمامات المنتجات | إضافة/عرض/حذف منتجات مهتم بها الليد |
| | حذف الليد | مع تأكيد؛ ممنوع إن وُجدت طلبات مرتبطة |
| **إنشاء الطلب من الليد** | صفحة إنشاء الطلب | بيانات الشحن (من الليد)، عناصر الطلب، نوع الدفع، صورة التحويل |
| | API | POST /api/orders مع multer، ربط عميل تلقائي إن لم يكن مربوطاً |
| **الطلبات** | قائمة الطلبات | جدول، فلتر بالحالة، ترقيم، رابط التفاصيل |
| | تفاصيل الطلب | بيانات الشحن، العناصر، الإجمالي، صورة التحويل |
| | تأكيد/رفض من الحسابات | أزرار في تفاصيل الطلب (لطلبات بانتظار الحسابات) |
| | API | GET /, GET /:id, POST /, PATCH /:id (confirm/reject) |
| **طلبات بانتظار الحسابات** | صفحة مخصصة | قائمة بطلبات pending_accounts فقط |
| **العملاء** | قائمة العملاء | بحث بالاسم/الجوال، ترقيم، عدد الليدز والطلبات |
| | تفاصيل العميل | بيانات العميل، جدول الليدز، جدول الطلبات مع روابط |
| | API | GET /, GET /:id |
| **التقارير** | صفحة تقارير | ملخص عام (إجمالي الليدز، الطلبات، بانتظار الحسابات) |
| **المنتجات** | صفحة المنتجات | جدول المنتجات (الاسم، معرف ووكومرس) من API |
| | API | GET /api/products (موجود مسبقاً) |
| **الحسابات (المستخدمون)** | صفحة المستخدمين | جدول (الاسم، البريد، الدور) |
| | API | GET /api/users (موجود مسبقاً) |
| **الشيفتات** | إدارة الشيفتات | إضافة شيفت (اسم، وقت بداية/نهاية)، حذف شيفت |
| | أعضاء الشيفت | إضافة/إزالة أعضاء من شيفت |
| | API | GET /, GET /:id, POST /, PATCH /:id, DELETE /:id, POST /:id/members, DELETE /:id/members/:userId |
| **حالات الليد** | API | GET /api/lead-statuses (قائمة، إضافة، حذف) |
| **الملفات** | رفع صورة التحويل | تخزين في backend/uploads، خدمة عبر /uploads |

---

## 2. المتبقي تنفيذه

| القسم | الميزة | ملاحظات |
|--------|--------|----------|
| **ووكومرس** | رفع الطلب على ووكومرس | بعد تأكيد الحسابات: إرسال الطلب إلى WooCommerce عبر REST API (يحتاج إعداد URL + Consumer Key/Secret) |
| | مزامنة المنتجات من ووكومرس | جلب/تحديث المنتجات من ووكومرس (Webhook أو زر «تحديث» يدوي) |
| **التقارير** | تقارير متقدمة | تقارير حسب الفترة الزمنية، حسب المصدر، رسوم بيانية |
| **الداشبورد** | رسوم بيانية | مخططات (مثلاً: ليدز خلال الشهر، طلبات مؤكدة مقابل مرفوضة) |
| **الحسابات** | إدارة المستخدمين | إضافة/تعديل/تعطيل مستخدم، ربط بالأدوار والصلاحيات (الـ API حالياً للقراءة فقط) |
| **الأدوار والصلاحيات** | صلاحيات تفصيلية | استخدام جدول Permissions و RolePermission في القوائم والأزرار (حالياً الدخول للمصادقين فقط) |
| **الشفترات** | توزيع الليدز (Round Robin) | آلية توزيع ليدز جديدة تلقائياً على أعضاء الشيفت حسب orderNum (البنية جاهزة، المنطق غير مربوط) |
| **بلجن ووردبريس** | استقبال الليدز من الموقع | بلجن ووردبريس يستقبل إرسالات من Elementor أو Contact Form 7 ويرسلها لـ API دولفين (مشروع منفصل) |
| **الإشعارات** | إشعارات داخل التطبيق | استخدام جدول Notification وإشعار المستخدمين (مثلاً: طلب رد مطلوب منك، طلب جديد بانتظار الحسابات) |
| **التدقيق (Audit Log)** | سجل التغييرات | تسجيل التعديلات في جدول AuditLog وعرضها في واجهة (الـ Schema جاهز) |

---

## ملخص سريع

| | تم | متبقي |
|---|:---:|:---:|
| **عدد الأقسام الرئيسية المنفذة** | 10 (داشبورد، ليدز، عملاء، طلبات، طلبات بانتظار، تقارير، منتجات، حسابات، شيفتات، إنشاء طلب) | تكاملات وتحسينات |
| **رفع على ووكومرس** | — | نعم |
| **مزامنة منتجات ووكومرس** | — | نعم |
| **بلجن ووردبريس** | — | نعم |
| **تقارير متقدمة + صلاحيات + إشعارات** | — | اختياري |
